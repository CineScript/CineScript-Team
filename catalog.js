import{f as G,d as H,c as R,s as Y,b as P}from"./assets/scroll-up-zjQ1apRV.js";const N=document.querySelector("#trailerModal"),A=document.querySelector("#trailerIframe"),J=N.querySelectorAll("[data-close]");function z(e){A.src=`https://www.youtube.com/embed/${e}?autoplay=1`,N.classList.remove("is-hidden"),document.body.style.overflow="hidden"}function D(){A.src="",N.classList.add("is-hidden"),document.body.style.overflow=""}document.addEventListener("keydown",e=>{e.key==="Escape"&&D()});J.forEach(e=>{e.addEventListener("click",D)});async function M(e,t){let n=document.querySelector("#catalog-popup-template");if(!n){const i="./popup.html";try{const l=await fetch(i);if(!l.ok){console.error(`Popup.html yüklenemedi. Durum: ${l.status}, URL: ${l.url}`);return}const o=await l.text(),s=document.createElement("div");s.innerHTML=o;const a=s.querySelector(".movie-popup-section");if(!a){console.error(".movie-popup-section bulunamadı.");return}a.id="catalog-popup-template",document.body.appendChild(a),await $(a,e,t)}catch(l){console.error("Popup yüklenirken bir hata oluştu:",l)}return}const r=n.cloneNode(!0);r.id="",r.querySelector(".movie-popup-overlay"),await $(r,e,t)}async function $(e,t,n){e.style.display="block";const r=e.querySelector(".movie-popup-overlay"),i=r.querySelector(".movie-popup-img");i.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",i.alt=t.title,r.querySelector(".movie-popup-title").textContent=t.title,r.querySelector(".vote-avg").textContent=t.vote_average?.toFixed(1)??"-",r.querySelector(".vote-count").textContent=t.vote_count??"-",r.querySelector(".popularity-value").textContent=t.popularity?.toFixed(1)??"-";let l="-";t.genre_names?.length?l=t.genre_names.join(", "):t.genres?.length?l=t.genres.map(c=>c.name).join(", "):t.genre_ids?.length&&(l=t.genre_ids.map(c=>n[c]||c).join(", ")),r.querySelector(".genre-value").textContent=l,r.querySelector(".about-value").textContent=t.overview||"No description.";const o=r.querySelector(".movie-popup-add-btn");if(o){const j=(JSON.parse(localStorage.getItem("library"))||[]).includes(t.id);o.onclick=()=>{let g=JSON.parse(localStorage.getItem("library"))||[];g.includes(t.id)?(g=g.filter(F=>F!==t.id),localStorage.setItem("library",JSON.stringify(g)),o.textContent="Add to library",o.classList.remove("removed")):(g.push(t.id),localStorage.setItem("library",JSON.stringify(g)),o.textContent="Remove from library",o.classList.add("removed"))},j?(o.textContent="Remove from library",o.classList.add("removed")):(o.textContent="Add to library",o.classList.remove("removed"))}const s=r.querySelector(".movie-popup-close"),a=window.location.hostname==="localhost",f=a?"":window.location.pathname.split("/")[1],I=a?"":`/${f}`;s.addEventListener("mouseenter",()=>{s.querySelector("img").src=`${I}/img/svg/close-hover.svg`}),s.addEventListener("mouseleave",()=>{s.querySelector("img").src=`${I}/img/svg/close.svg`}),s.addEventListener("click",()=>b()),r.addEventListener("mousedown",c=>{c.target===r&&b()}),document.addEventListener("keydown",function(c){c.key==="Escape"&&b()}),document.body.appendChild(e)}function b(){const e=document.querySelector(".movie-popup-section")||document.querySelector("#catalog-popup-template");e&&e.remove()}const V=document.querySelector(".catalog-hero"),U=document.querySelector(".catalog-hero-title"),W=document.querySelector(".catalog-hero-overview"),Z=document.querySelector(".catalog-hero-rating"),K=document.querySelector(".catalog-hero-btn.trailer"),Q=document.querySelector(".catalog-hero-btn.details");let E=null,x=null;async function X(){try{const t=(await G()).results;if(!t||t.length===0)return;const n=t[Math.floor(Math.random()*t.length)];E=n.id,x=n;const r=n.backdrop_path||n.poster_path,i=r?`https://image.tmdb.org/t/p/original${r}`:"";i&&V.style.setProperty("--hero-bg",`url(${i})`),U.textContent=n.title||n.name||"No title",W.textContent=n.overview||"No description available",Z.innerHTML=ee(n.vote_average)}catch(e){console.error("Hero verisi alınamadı:",e)}}function ee(e){const t=Math.floor(e/2),n=e%2>=1?"½":"";return"★".repeat(t)+(n?"★":"")+"☆".repeat(5-t-(n?1:0))}async function te(){if(E)try{const t=(await H(E)).results.find(n=>n.type==="Trailer"&&n.site==="YouTube");t?z(t.key):alert("Trailer not found.")}catch(e){console.error("Trailer yüklenemedi:",e)}}K.addEventListener("click",te);Q.addEventListener("click",()=>{x&&M(x)});X();console.log("catalog.js yüklendi!");const w=document.getElementById("search-form"),h=document.getElementById("movie-list"),d=document.getElementById("no-results"),v=15,T=60,ne=20,re=Math.ceil(T/ne);let L=[],u=1,m=Math.ceil(T/v),C=null,p=document.createElement("div");p.className="pagination-container";function B(e,t){p.innerHTML="";function n(o,s){const a=document.createElement("button");a.className="pagination-arrow",a.disabled=s;let f="";return o==="prev"?f='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17.9375 6.125L10.0625 14L17.9375 21.875" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>':f='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.0625 21.875L17.9375 14L10.0625 6.125" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>',a.innerHTML=f,p.appendChild(a),a}function r(o,s){const a=document.createElement("button");a.className="pagination-page"+(s?" active":""),a.textContent=o,a.addEventListener("click",()=>k(o)),p.appendChild(a)}n("prev",e===1).addEventListener("click",()=>k(e-1));for(let o=1;o<=t;o++)r(o,e===o);n("next",e===t).addEventListener("click",()=>k(e+1))}function k(e){if(e<1||e>m)return;u=e,_(q(u,C||L)),B(u,m)}function q(e,t=L){const n=(e-1)*v;return t.slice(n,n+v)}function oe(e){const t=Math.floor(e/2),n=e%2>=1?1:0,r=5-t-n;return'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="#f87719" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(t)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><defs><linearGradient id="half-grad" x1="0" x2="1" y1="0" y2="0"><stop offset="50%" stop-color="#f87719"/><stop offset="50%" stop-color="transparent"/></linearGradient></defs><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="url(#half-grad)" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(n)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="none" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(r)}function ae(e,t){const n=document.createElement("li");n.classList.add("movie-item","movie-catalog-item");const r=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"https://via.placeholder.com/300x450?text=No+Image",i=e.release_date?.split("-")[0]||"Bilinmiyor",l=e.vote_average||0;let o="Tür bilinmiyor";e.genre_ids&&t?o=e.genre_ids.map(a=>t[a]||a).join(", "):e.genres&&Array.isArray(e.genres)&&(o=e.genres.map(a=>a.name).join(", "));const s=oe(l);return n.innerHTML=`
    <img src="${r}" alt="${e.title}" class="catalog-film-poster" />
    <div class="catalog-overlay">
      <h3 class="catalog-film-title">${e.title}</h3>
      <div class="movie-catalog-bottom-row">
        <p class="movie-catalog-film-info">${o} | ${i}</p>
        <div class="movie-catalog-stars">${s}</div>
      </div>
    </div>
  `,n.addEventListener("click",()=>{typeof M=="function"&&M(e,t)}),n}function _(e){if(h.innerHTML="",!e||e.length===0){d.style.display="block",p.style.display="none";return}d.style.display="none",p.style.display="",window._genreMap||(window._genreMap=null);const t=window._genreMap;e.forEach(n=>{const r=ae(n,t);r._movieData=n,h.appendChild(r)})}async function le(){if(window._genreMap)return window._genreMap;if(typeof P=="function"){const e=await P();console.log("fetchGenres sonucu:",e);const t={};return e.genres&&Array.isArray(e.genres)&&e.genres.forEach(n=>{t[n.id]=n.name}),window._genreMap=t,t}return null}let O="";const y=document.querySelector(".year-dropdown");y.style.display="none";const se=y.querySelector(".year-selected"),S=y.querySelector(".year-options"),ie=y.querySelector(".year-label"),ce=new Date().getFullYear();for(let e=ce;e>=1900;e--){const t=document.createElement("li");t.textContent=e,t.addEventListener("click",()=>{O=e,ie.textContent=e,S.classList.add("hidden")}),S.appendChild(t)}se.addEventListener("click",e=>{e.stopPropagation(),S.classList.toggle("hidden")});document.addEventListener("click",e=>{y.contains(e.target)||S.classList.add("hidden")});function de(){const e=document.getElementById("search-input");if(!e)return;if(!e.parentNode.classList.contains("search-input-wrapper")){const r=document.createElement("div");r.className="search-input-wrapper",e.parentNode.insertBefore(r,e),r.appendChild(e)}const t=e.parentNode;if(t.querySelector(".search-clear-btn"))return;const n=document.createElement("button");n.type="button",n.className="search-clear-btn",n.innerHTML=`
    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.5 4.5L4.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
      <path d="M4.5 4.5L13.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
    </svg>
  `,n.style.display="none",n.addEventListener("click",()=>{e.value="",e.focus(),n.style.display="none"}),t.appendChild(n),e.addEventListener("input",()=>{n.style.display=e.value?"flex":"none"}),n.style.display=e.value?"flex":"none"}document.addEventListener("DOMContentLoaded",()=>{ue(),de()});async function ue(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!w||!h||!d){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}try{let e=[];for(let n=1;n<=re;n++){const r=await R(n);e=e.concat(r.results)}L=e.slice(0,T),m=Math.ceil(L.length/v),u=1;const t=await le();console.log("Genre map:",t),_(q(u)),B(u,m),p.parentNode||h.parentNode.insertBefore(p,h.nextSibling),w.addEventListener("submit",async n=>{n.preventDefault();const r=document.getElementById("search-input").value.trim(),i=O;if(r)try{let o=(await Y(r)).results;i&&(o=o.filter(s=>s.release_date&&s.release_date.startsWith(i))),C=o,m=Math.ceil(o.length/v),u=1,_(q(u,C)),B(u,m),y.style.display="inline-block",w.classList.add("active"),o.length===0?d.style.display="block":d.style.display="none"}catch(l){console.error("Arama sırasında hata oluştu:",l),d.style.display="block",d.textContent="Film bulunamadı veya bir hata oluştu.",y.style.display="inline-block",w.classList.add("active")}})}catch(e){console.error("Filmler yüklenirken hata:",e),d.style.display="block",d.textContent="Filmler yüklenirken hata oluştu."}}
//# sourceMappingURL=catalog.js.map
