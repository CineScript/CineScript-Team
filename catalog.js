import{b,f as F,d as G,c as R,s as Y}from"./assets/scroll-up-wgesbndo.js";const _=document.querySelector("#trailerModal"),I=document.querySelector("#trailerIframe"),V=_.querySelectorAll("[data-close]");function z(e){I.src=`https://www.youtube.com/embed/${e}?autoplay=1`,_.classList.remove("is-hidden"),document.body.style.overflow="hidden"}function P(){I.src="",_.classList.add("is-hidden"),document.body.style.overflow=""}document.addEventListener("keydown",e=>{e.key==="Escape"&&P()});V.forEach(e=>{e.addEventListener("click",P)});const S="data:image/svg+xml,%3csvg%20class='popup-close-icon'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%3e%3cpath%20d='M6%206L18%2018'%20stroke='currentColor'%20stroke-width='2'/%3e%3cpath%20d='M6%2018L18%206'%20stroke='currentColor'%20stroke-width='2'/%3e%3c/svg%3e%3c/button%3e",J="data:image/svg+xml,%3csvg%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11.25%2011.25L0.75%200.75M11.25%200.75L0.75%2011.25'%20stroke='%23F87719'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";let h=null;async function U(){if(h)return h;const e=await b();return h={},e.genres&&Array.isArray(e.genres)&&e.genres.forEach(t=>{h[t.id]=t.name}),h}function $(){const e=localStorage.getItem("library");return e?JSON.parse(e):[]}function W(e){localStorage.setItem("library",JSON.stringify(e))}function Z(e,t){let n=$();const o=e.id;n.includes(o)?(n=n.filter(s=>s!==o),t.textContent="Add to library",t.classList.remove("removed")):(n.push(o),t.textContent="Remove from my library",t.classList.add("removed")),W(n)}function K(e,t){$().includes(e.id)?(t.textContent="Remove from my library",t.classList.add("removed")):(t.textContent="Add to library",t.classList.remove("removed"))}async function v(e){let t=document.querySelector("#popup-template");if(!t){const o=window.location.hostname==="localhost";let s;o?s="/popup.html":s=`/${window.location.pathname.split("/")[1]}/popup.html`,fetch(s).then(i=>{if(!i.ok)throw console.error(`Popup.html yüklenemedi. Durum: ${i.status}, URL: ${i.url}`),new Error("Network response was not ok.");return i.text()}).then(async i=>{const r=document.createElement("div");r.innerHTML=i;const l=r.querySelector(".movie-popup-overlay");l?(l.id="popup-template",document.body.appendChild(l),await A(l,e)):console.error("movie-popup-overlay bulunamadı, HTML içeriği yanlış olabilir.")}).catch(i=>{console.error("Popup yüklenirken bir hata oluştu:",i)});return}const n=t.cloneNode(!0);n.id="",await A(n,e)}async function A(e,t){e.style.display="flex";const n=e.querySelector(".movie-popup-img");n.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",n.alt=t.title,e.querySelector(".movie-popup-title").textContent=t.title;const o=t.vote_average!=null?t.vote_average.toFixed(1):"-";e.querySelector(".vote-avg").textContent=o,e.querySelector(".vote-count").textContent=t.vote_count??"-";const s=t.popularity!=null?t.popularity.toFixed(1):"-";e.querySelector(".popularity-value").textContent=s;let i="-";if(t.genre_names&&Array.isArray(t.genre_names))i=t.genre_names.join(", ");else if(t.genre_ids&&Array.isArray(t.genre_ids)){const c=await U();i=t.genre_ids.map(T=>c[T]||T).join(", ")}e.querySelector(".genre-value").textContent=i,e.querySelector(".about-value").textContent=t.overview||"No description.";const r=e.querySelector(".movie-popup-add-btn");r&&(K(t,r),r.addEventListener("click",function(){Z(t,this)}));const l=e.querySelector(".movie-popup-close");let a=l.querySelector("img");a||(a=document.createElement("img"),a.alt="close",a.className="close-icon",a.width=24,a.height=24,a.style.width="24px",a.style.height="24px",a.src=S,l.appendChild(a)),window.location.hostname==="localhost"||window.location.pathname.split("/")[1],l.addEventListener("mouseenter",()=>{l.querySelector("img").src=J}),l.addEventListener("mouseleave",()=>{l.querySelector("img").src=S}),l.addEventListener("click",()=>e.remove());function N(c){c.key==="Escape"&&(e.remove(),document.removeEventListener("keydown",N))}if(document.addEventListener("keydown",N),e.addEventListener("mousedown",function(c){c.target===e&&e.remove()}),document.body.appendChild(e),l){l.innerHTML="";const c=document.createElement("img");c.alt="close",c.className="close-icon",c.width=24,c.height=24,c.style.width="24px",c.style.height="24px",c.src=S,l.appendChild(c)}}const Q=document.querySelector(".catalog-hero"),X=document.querySelector(".catalog-hero-title"),O=document.querySelector(".catalog-hero-overview"),ee=document.querySelector(".catalog-hero-rating"),te=document.querySelector(".catalog-hero-btn.trailer"),ne=document.querySelector(".catalog-hero-btn.details");let x=null,E=null;async function oe(){try{const t=(await F()).results;if(!t||t.length===0)return;const n=t[Math.floor(Math.random()*t.length)];x=n.id,E=n;const o=n.backdrop_path||n.poster_path,s=o?`https://image.tmdb.org/t/p/original${o}`:"";s&&Q.style.setProperty("--hero-bg",`url(${s})`),X.textContent=n.title||n.name||"No title",O.textContent=n.overview||"No description available",ee.innerHTML=re(n.vote_average)}catch(e){console.error("Hero verisi alınamadı:",e)}}function re(e){const t=Math.floor(e/2),n=e%2>=1?"½":"";return"★".repeat(t)+(n?"★":"")+"☆".repeat(5-t-(n?1:0))}async function ae(){if(x)try{const t=(await G(x)).results.find(n=>n.type==="Trailer"&&n.site==="YouTube");t?z(t.key):alert("Trailer not found.")}catch(e){console.error("Trailer yüklenemedi:",e)}}te.addEventListener("click",ae);ne.addEventListener("click",()=>{E&&v(E)});oe();console.log("catalog.js yüklendi!");const y=document.getElementById("search-form"),u=document.getElementById("movie-list"),d=document.getElementById("no-results"),w=15,q=60,le=20,ie=Math.ceil(q/le);let C=[],m=1,L=Math.ceil(q/w),g=document.createElement("div");g.className="pagination-container";function se(){u.addEventListener("click",e=>{const t=e.target.closest("li.movie-item");if(!t)return;const n=Array.from(u.children).indexOf(t),s=Array.from(u.children).map(i=>i._movieData).filter(Boolean)[n];s&&v(s)})}function D(e,t){g.innerHTML="";function n(r,l){const a=document.createElement("button");a.className="pagination-arrow",a.disabled=l;let f="";return r==="prev"?f='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17.9375 6.125L10.0625 14L17.9375 21.875" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>':f='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.0625 21.875L17.9375 14L10.0625 6.125" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>',a.innerHTML=f,g.appendChild(a),a}function o(r,l){const a=document.createElement("button");a.className="pagination-page"+(l?" active":""),a.textContent=r,a.addEventListener("click",()=>M(r)),g.appendChild(a)}n("prev",e===1).addEventListener("click",()=>M(e-1));for(let r=1;r<=t;r++)o(r,e===r);n("next",e===t).addEventListener("click",()=>M(e+1))}function M(e){e<1||e>L||(m=e,B(H(m)),D(m,L))}function H(e){const t=(e-1)*w;return C.slice(t,t+w)}function ce(e){const t=Math.floor(e/2),n=e%2>=1?1:0,o=5-t-n;return'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="#f87719" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(t)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><defs><linearGradient id="half-grad" x1="0" x2="1" y1="0" y2="0"><stop offset="50%" stop-color="#f87719"/><stop offset="50%" stop-color="transparent"/></linearGradient></defs><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="url(#half-grad)" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(n)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="none" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(o)}function de(e,t){const n=document.createElement("li");n.classList.add("movie-item","movie-catalog-item");const o=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"https://via.placeholder.com/300x450?text=No+Image",s=e.release_date?.split("-")[0]||"Bilinmiyor",i=e.vote_average||0;let r="Tür bilinmiyor";e.genre_ids&&t?r=e.genre_ids.map(a=>t[a]||a).join(", "):e.genres&&Array.isArray(e.genres)&&(r=e.genres.map(a=>a.name).join(", "));const l=ce(i);return n.innerHTML=`
    <img src="${o}" alt="${e.title}" class="catalog-film-poster" />
    <div class="catalog-overlay">
      <h3 class="catalog-film-title">${e.title}</h3>
      <div class="movie-catalog-bottom-row">
        <p class="movie-catalog-film-info">${r} | ${s}</p>
        <div class="movie-catalog-stars">${l}</div>
      </div>
    </div>
  `,n.addEventListener("click",()=>{typeof v=="function"&&v(e)}),n}function B(e){if(u.innerHTML="",!e||e.length===0){d.style.display="block";return}d.style.display="none",window._genreMap||(window._genreMap=null);const t=window._genreMap;e.forEach(n=>{const o=de(n,t);o._movieData=n,u.appendChild(o)})}async function ue(){if(window._genreMap)return window._genreMap;if(typeof b=="function"){const e=await b();console.log("fetchGenres sonucu:",e);const t={};return e.genres&&Array.isArray(e.genres)&&e.genres.forEach(n=>{t[n.id]=n.name}),window._genreMap=t,t}return null}let j="";const p=document.querySelector(".year-dropdown");p.style.display="none";const pe=p.querySelector(".year-selected"),k=p.querySelector(".year-options"),me=p.querySelector(".year-label"),ge=new Date().getFullYear();for(let e=ge;e>=1900;e--){const t=document.createElement("li");t.textContent=e,t.addEventListener("click",()=>{j=e,me.textContent=e,k.classList.add("hidden")}),k.appendChild(t)}pe.addEventListener("click",e=>{e.stopPropagation(),k.classList.toggle("hidden")});document.addEventListener("click",e=>{p.contains(e.target)||k.classList.add("hidden")});function he(){const e=document.getElementById("search-input");if(!e)return;if(!e.parentNode.classList.contains("search-input-wrapper")){const o=document.createElement("div");o.className="search-input-wrapper",e.parentNode.insertBefore(o,e),o.appendChild(e)}const t=e.parentNode;if(t.querySelector(".search-clear-btn"))return;const n=document.createElement("button");n.type="button",n.className="search-clear-btn",n.innerHTML=`
    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.5 4.5L4.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
      <path d="M4.5 4.5L13.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
    </svg>
  `,n.style.display="none",n.addEventListener("click",()=>{e.value="",e.focus(),n.style.display="none"}),t.appendChild(n),e.addEventListener("input",()=>{n.style.display=e.value?"flex":"none"}),n.style.display=e.value?"flex":"none"}document.addEventListener("DOMContentLoaded",()=>{fe(),se(),he()});async function fe(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!y||!u||!d){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}try{let e=[];for(let n=1;n<=ie;n++){const o=await R(n);e=e.concat(o.results)}C=e.slice(0,q),L=Math.ceil(C.length/w),m=1;const t=await ue();console.log("Genre map:",t),B(H(m)),D(m,L),g.parentNode||u.parentNode.insertBefore(g,u.nextSibling),y.addEventListener("submit",async n=>{n.preventDefault();const o=document.getElementById("search-input").value.trim(),s=j;if(o)try{let r=(await Y(o)).results;s&&(r=r.filter(l=>l.release_date&&l.release_date.startsWith(s))),B(r),p.style.display="inline-block",y.classList.add("active"),r.length===0?d.style.display="block":d.style.display="none"}catch(i){console.error("Arama sırasında hata oluştu:",i),d.style.display="block",d.textContent="Film bulunamadı veya bir hata oluştu.",p.style.display="inline-block",y.classList.add("active")}})}catch(e){console.error("Filmler yüklenirken hata:",e),d.style.display="block",d.textContent="Filmler yüklenirken hata oluştu."}}
//# sourceMappingURL=catalog.js.map
