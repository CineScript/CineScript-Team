import{b as x,f as G,d as R,c as Y,s as V}from"./assets/scroll-up-B6SiUYiZ.js";const T=document.querySelector("#trailerModal"),D=document.querySelector("#trailerIframe"),z=T.querySelectorAll("[data-close]");function J(e){D.src=`https://www.youtube.com/embed/${e}?autoplay=1`,T.classList.remove("is-hidden"),document.body.style.overflow="hidden"}function H(){D.src="",T.classList.add("is-hidden"),document.body.style.overflow=""}document.addEventListener("keydown",e=>{e.key==="Escape"&&H()});z.forEach(e=>{e.addEventListener("click",H)});const M="data:image/svg+xml,%3csvg%20class='popup-close-icon'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%3e%3cpath%20d='M6%206L18%2018'%20stroke='currentColor'%20stroke-width='2'/%3e%3cpath%20d='M6%2018L18%206'%20stroke='currentColor'%20stroke-width='2'/%3e%3c/svg%3e%3c/button%3e",U="data:image/svg+xml,%3csvg%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11.25%2011.25L0.75%200.75M11.25%200.75L0.75%2011.25'%20stroke='%23F87719'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";let y=null;async function W(){if(y)return y;const e=await x();return y={},e.genres&&Array.isArray(e.genres)&&e.genres.forEach(t=>{y[t.id]=t.name}),y}function j(){const e=localStorage.getItem("library");return e?JSON.parse(e):[]}function Z(e){localStorage.setItem("library",JSON.stringify(e))}function K(e,t){let n=j();const o=e.id;n.includes(o)?(n=n.filter(i=>i!==o),t.textContent="Add to library",t.classList.remove("removed")):(n.push(o),t.textContent="Remove from my library",t.classList.add("removed")),Z(n)}function Q(e,t){j().includes(e.id)?(t.textContent="Remove from my library",t.classList.add("removed")):(t.textContent="Add to library",t.classList.remove("removed"))}async function L(e){let t=document.querySelector("#popup-template");if(!t){const o=window.location.hostname==="localhost";let i;o?i="/popup.html":i=`/${window.location.pathname.split("/")[1]}/popup.html`,fetch(i).then(s=>{if(!s.ok)throw console.error(`Popup.html yüklenemedi. Durum: ${s.status}, URL: ${s.url}`),new Error("Network response was not ok.");return s.text()}).then(async s=>{const r=document.createElement("div");r.innerHTML=s;const l=r.querySelector(".movie-popup-overlay");l?(l.id="popup-template",document.body.appendChild(l),await $(l,e)):console.error("movie-popup-overlay bulunamadı, HTML içeriği yanlış olabilir.")}).catch(s=>{console.error("Popup yüklenirken bir hata oluştu:",s)});return}const n=t.cloneNode(!0);n.id="",await $(n,e)}async function $(e,t){e.style.display="flex";const n=e.querySelector(".movie-popup-img");n.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",n.alt=t.title,e.querySelector(".movie-popup-title").textContent=t.title;const o=t.vote_average!=null?t.vote_average.toFixed(1):"-";e.querySelector(".vote-avg").textContent=o,e.querySelector(".vote-count").textContent=t.vote_count??"-";const i=t.popularity!=null?t.popularity.toFixed(1):"-";e.querySelector(".popularity-value").textContent=i;let s="-";if(t.genre_names&&Array.isArray(t.genre_names))s=t.genre_names.join(", ");else if(t.genre_ids&&Array.isArray(t.genre_ids)){const c=await W();s=t.genre_ids.map(P=>c[P]||P).join(", ")}e.querySelector(".genre-value").textContent=s,e.querySelector(".about-value").textContent=t.overview||"No description.";const r=e.querySelector(".movie-popup-add-btn");r&&(Q(t,r),r.addEventListener("click",function(){K(t,this)}));const l=e.querySelector(".movie-popup-close");let a=l.querySelector("img");a||(a=document.createElement("img"),a.alt="close",a.className="close-icon",a.width=24,a.height=24,a.style.width="24px",a.style.height="24px",a.src=M,l.appendChild(a)),window.location.hostname==="localhost"||window.location.pathname.split("/")[1],l.addEventListener("mouseenter",()=>{l.querySelector("img").src=U}),l.addEventListener("mouseleave",()=>{l.querySelector("img").src=M}),l.addEventListener("click",()=>e.remove());function I(c){c.key==="Escape"&&(e.remove(),document.removeEventListener("keydown",I))}if(document.addEventListener("keydown",I),e.addEventListener("mousedown",function(c){c.target===e&&e.remove()}),document.body.appendChild(e),l){l.innerHTML="";const c=document.createElement("img");c.alt="close",c.className="close-icon",c.width=24,c.height=24,c.style.width="24px",c.style.height="24px",c.src=M,l.appendChild(c)}}const X=document.querySelector(".catalog-hero"),O=document.querySelector(".catalog-hero-title"),ee=document.querySelector(".catalog-hero-overview"),te=document.querySelector(".catalog-hero-rating"),ne=document.querySelector(".catalog-hero-btn.trailer"),oe=document.querySelector(".catalog-hero-btn.details");let E=null,C=null;async function re(){try{const t=(await G()).results;if(!t||t.length===0)return;const n=t[Math.floor(Math.random()*t.length)];E=n.id,C=n;const o=n.backdrop_path||n.poster_path,i=o?`https://image.tmdb.org/t/p/original${o}`:"";i&&X.style.setProperty("--hero-bg",`url(${i})`),O.textContent=n.title||n.name||"No title",ee.textContent=n.overview||"No description available",te.innerHTML=ae(n.vote_average)}catch(e){console.error("Hero verisi alınamadı:",e)}}function ae(e){const t=Math.floor(e/2),n=e%2>=1?"½":"";return"★".repeat(t)+(n?"★":"")+"☆".repeat(5-t-(n?1:0))}async function le(){if(E)try{const t=(await R(E)).results.find(n=>n.type==="Trailer"&&n.site==="YouTube");t?J(t.key):alert("Trailer not found.")}catch(e){console.error("Trailer yüklenemedi:",e)}}ne.addEventListener("click",le);oe.addEventListener("click",()=>{C&&L(C)});re();console.log("catalog.js yüklendi!");const w=document.getElementById("search-form"),p=document.getElementById("movie-list"),d=document.getElementById("no-results"),f=15,A=60,se=20,ie=Math.ceil(A/se);let k=[],u=1,h=Math.ceil(A/f),B=null,m=document.createElement("div");m.className="pagination-container";function ce(){p.addEventListener("click",e=>{const t=e.target.closest("li.movie-item");if(!t)return;const n=Array.from(p.children).indexOf(t),i=Array.from(p.children).map(s=>s._movieData).filter(Boolean)[n];i&&L(i)})}function _(e,t){m.innerHTML="";function n(r,l){const a=document.createElement("button");a.className="pagination-arrow",a.disabled=l;let v="";return r==="prev"?v='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17.9375 6.125L10.0625 14L17.9375 21.875" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>':v='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.0625 21.875L17.9375 14L10.0625 6.125" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>',a.innerHTML=v,m.appendChild(a),a}function o(r,l){const a=document.createElement("button");a.className="pagination-page"+(l?" active":""),a.textContent=r,a.addEventListener("click",()=>b(r)),m.appendChild(a)}n("prev",e===1).addEventListener("click",()=>b(e-1));for(let r=1;r<=t;r++)o(r,e===r);n("next",e===t).addEventListener("click",()=>b(e+1))}function b(e){if(e<1||e>h)return;u=e,N(q(u,B||k)),_(u,h)}function q(e,t=k){const n=(e-1)*f;return t.slice(n,n+f)}function de(e){const t=Math.floor(e/2),n=e%2>=1?1:0,o=5-t-n;return'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="#f87719" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(t)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><defs><linearGradient id="half-grad" x1="0" x2="1" y1="0" y2="0"><stop offset="50%" stop-color="#f87719"/><stop offset="50%" stop-color="transparent"/></linearGradient></defs><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="url(#half-grad)" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(n)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="none" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(o)}function ue(e,t){const n=document.createElement("li");n.classList.add("movie-item","movie-catalog-item");const o=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"https://via.placeholder.com/300x450?text=No+Image",i=e.release_date?.split("-")[0]||"Bilinmiyor",s=e.vote_average||0;let r="Tür bilinmiyor";e.genre_ids&&t?r=e.genre_ids.map(a=>t[a]||a).join(", "):e.genres&&Array.isArray(e.genres)&&(r=e.genres.map(a=>a.name).join(", "));const l=de(s);return n.innerHTML=`
    <img src="${o}" alt="${e.title}" class="catalog-film-poster" />
    <div class="catalog-overlay">
      <h3 class="catalog-film-title">${e.title}</h3>
      <div class="movie-catalog-bottom-row">
        <p class="movie-catalog-film-info">${r} | ${i}</p>
        <div class="movie-catalog-stars">${l}</div>
      </div>
    </div>
  `,n.addEventListener("click",()=>{typeof L=="function"&&L(e)}),n}function N(e){if(p.innerHTML="",!e||e.length===0){d.style.display="block",m.style.display="none";return}d.style.display="none",m.style.display="",window._genreMap||(window._genreMap=null);const t=window._genreMap;e.forEach(n=>{const o=ue(n,t);o._movieData=n,p.appendChild(o)})}async function pe(){if(window._genreMap)return window._genreMap;if(typeof x=="function"){const e=await x();console.log("fetchGenres sonucu:",e);const t={};return e.genres&&Array.isArray(e.genres)&&e.genres.forEach(n=>{t[n.id]=n.name}),window._genreMap=t,t}return null}let F="";const g=document.querySelector(".year-dropdown");g.style.display="none";const me=g.querySelector(".year-selected"),S=g.querySelector(".year-options"),ge=g.querySelector(".year-label"),he=new Date().getFullYear();for(let e=he;e>=1900;e--){const t=document.createElement("li");t.textContent=e,t.addEventListener("click",()=>{F=e,ge.textContent=e,S.classList.add("hidden")}),S.appendChild(t)}me.addEventListener("click",e=>{e.stopPropagation(),S.classList.toggle("hidden")});document.addEventListener("click",e=>{g.contains(e.target)||S.classList.add("hidden")});function ye(){const e=document.getElementById("search-input");if(!e)return;if(!e.parentNode.classList.contains("search-input-wrapper")){const o=document.createElement("div");o.className="search-input-wrapper",e.parentNode.insertBefore(o,e),o.appendChild(e)}const t=e.parentNode;if(t.querySelector(".search-clear-btn"))return;const n=document.createElement("button");n.type="button",n.className="search-clear-btn",n.innerHTML=`
    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.5 4.5L4.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
      <path d="M4.5 4.5L13.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
    </svg>
  `,n.style.display="none",n.addEventListener("click",()=>{e.value="",e.focus(),n.style.display="none"}),t.appendChild(n),e.addEventListener("input",()=>{n.style.display=e.value?"flex":"none"}),n.style.display=e.value?"flex":"none"}document.addEventListener("DOMContentLoaded",()=>{fe(),ce(),ye()});async function fe(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!w||!p||!d){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}try{let e=[];for(let n=1;n<=ie;n++){const o=await Y(n);e=e.concat(o.results)}k=e.slice(0,A),h=Math.ceil(k.length/f),u=1;const t=await pe();console.log("Genre map:",t),N(q(u)),_(u,h),m.parentNode||p.parentNode.insertBefore(m,p.nextSibling),w.addEventListener("submit",async n=>{n.preventDefault();const o=document.getElementById("search-input").value.trim(),i=F;if(o)try{let r=(await V(o)).results;i&&(r=r.filter(l=>l.release_date&&l.release_date.startsWith(i))),B=r,h=Math.ceil(r.length/f),u=1,N(q(u,B)),_(u,h),g.style.display="inline-block",w.classList.add("active"),r.length===0?d.style.display="block":d.style.display="none"}catch(s){console.error("Arama sırasında hata oluştu:",s),d.style.display="block",d.textContent="Film bulunamadı veya bir hata oluştu.",g.style.display="inline-block",w.classList.add("active")}})}catch(e){console.error("Filmler yüklenirken hata:",e),d.style.display="block",d.textContent="Filmler yüklenirken hata oluştu."}}
//# sourceMappingURL=catalog.js.map
