import{f as O,d as j,c as F,s as G,b as I}from"./assets/scroll-up-CLPXUGzI.js";const _=document.querySelector("#trailerModal"),P=document.querySelector("#trailerIframe"),H=_.querySelectorAll("[data-close]");function R(e){P.src=`https://www.youtube.com/embed/${e}?autoplay=1`,_.classList.remove("is-hidden"),document.body.style.overflow="hidden"}function A(){P.src="",_.classList.add("is-hidden"),document.body.style.overflow=""}document.addEventListener("keydown",e=>{e.key==="Escape"&&A()});H.forEach(e=>{e.addEventListener("click",A)});async function k(e,t){let n=document.querySelector("#catalog-popup-template");if(!n){const i="./popup.html";try{const l=await fetch(i);if(!l.ok){console.error(`Popup.html yüklenemedi. Durum: ${l.status}, URL: ${l.url}`);return}const a=await l.text(),s=document.createElement("div");s.innerHTML=a;const o=s.querySelector(".movie-popup-section");if(!o){console.error(".movie-popup-section bulunamadı.");return}o.id="catalog-popup-template",document.body.appendChild(o),await N(o,e,t)}catch(l){console.error("Popup yüklenirken bir hata oluştu:",l)}return}const r=n.cloneNode(!0);r.id="",r.querySelector(".movie-popup-overlay"),await N(r,e,t)}async function N(e,t,n){e.style.display="block";const r=e.querySelector(".movie-popup-overlay"),i=r.querySelector(".movie-popup-img");i.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",i.alt=t.title,r.querySelector(".movie-popup-title").textContent=t.title,r.querySelector(".vote-avg").textContent=t.vote_average?.toFixed(1)??"-",r.querySelector(".vote-count").textContent=t.vote_count??"-",r.querySelector(".popularity-value").textContent=t.popularity?.toFixed(1)??"-";let l="-";t.genre_names?.length?l=t.genre_names.join(", "):t.genres?.length?l=t.genres.map(o=>o.name).join(", "):t.genre_ids?.length&&(l=t.genre_ids.map(o=>n[o]||o).join(", ")),r.querySelector(".genre-value").textContent=l,r.querySelector(".about-value").textContent=t.overview||"No description.";const a=r.querySelector(".movie-popup-add-btn");if(a){const m=(JSON.parse(localStorage.getItem("library"))||[]).includes(t.id);a.onclick=()=>{let y=JSON.parse(localStorage.getItem("library"))||[];y.includes(t.id)?(y=y.filter(D=>D!==t.id),localStorage.setItem("library",JSON.stringify(y)),a.textContent="Add to library",a.classList.remove("removed")):(y.push(t.id),localStorage.setItem("library",JSON.stringify(y)),a.textContent="Remove from library",a.classList.add("removed"))},m?(a.textContent="Remove from library",a.classList.add("removed")):(a.textContent="Add to library",a.classList.remove("removed"))}const s=r.querySelector(".movie-popup-close");s.addEventListener("mouseenter",()=>{const o=s.querySelector(".close-icon");o&&o.classList.add("hovered")}),s.addEventListener("mouseleave",()=>{const o=s.querySelector(".close-icon");o&&o.classList.remove("hovered")}),s.addEventListener("click",()=>S()),r.addEventListener("mousedown",o=>{o.target===r&&S()}),document.addEventListener("keydown",function(o){o.key==="Escape"&&S()}),document.body.appendChild(e)}function S(){const e=document.querySelector(".movie-popup-section")||document.querySelector("#catalog-popup-template");e&&e.remove()}const Y=document.querySelector(".catalog-hero"),J=document.querySelector(".catalog-hero-title"),z=document.querySelector(".catalog-hero-overview"),V=document.querySelector(".catalog-hero-rating"),U=document.querySelector(".catalog-hero-btn.trailer"),W=document.querySelector(".catalog-hero-btn.details");let M=null,E=null;async function Z(){try{const t=(await O()).results;if(!t||t.length===0)return;const n=t[Math.floor(Math.random()*t.length)];M=n.id,E=n;const r=n.backdrop_path||n.poster_path,i=r?`https://image.tmdb.org/t/p/original${r}`:"";i&&Y.style.setProperty("--hero-bg",`url(${i})`),J.textContent=n.title||n.name||"No title",z.textContent=n.overview||"No description available",V.innerHTML=K(n.vote_average)}catch(e){console.error("Hero verisi alınamadı:",e)}}function K(e){const t=Math.floor(e/2),n=e%2>=1?"½":"";return"★".repeat(t)+(n?"★":"")+"☆".repeat(5-t-(n?1:0))}async function Q(){if(M)try{const t=(await j(M)).results.find(n=>n.type==="Trailer"&&n.site==="YouTube");t?R(t.key):alert("Trailer not found.")}catch(e){console.error("Trailer yüklenemedi:",e)}}U.addEventListener("click",Q);W.addEventListener("click",()=>{E&&k(E,{})});Z();console.log("catalog.js yüklendi!");const v=document.getElementById("search-form"),f=document.getElementById("movie-list"),c=document.getElementById("no-results"),h=15,T=60,X=20,ee=Math.ceil(T/X);let w=[],d=1,g=Math.ceil(T/h),x=null,u=document.createElement("div");u.className="pagination-container";function C(e,t){u.innerHTML="";function n(a,s){const o=document.createElement("button");o.className="pagination-arrow",o.disabled=s;let m="";return a==="prev"?m='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17.9375 6.125L10.0625 14L17.9375 21.875" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>':m='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.0625 21.875L17.9375 14L10.0625 6.125" stroke="#B7B7B7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></svg>',o.innerHTML=m,u.appendChild(o),o}function r(a,s){const o=document.createElement("button");o.className="pagination-page"+(s?" active":""),o.textContent=a,o.addEventListener("click",()=>b(a)),u.appendChild(o)}n("prev",e===1).addEventListener("click",()=>b(e-1));for(let a=1;a<=t;a++)r(a,e===a);n("next",e===t).addEventListener("click",()=>b(e+1))}function b(e){if(e<1||e>g)return;d=e,q(B(d,x||w)),C(d,g)}function B(e,t=w){const n=(e-1)*h;return t.slice(n,n+h)}function te(e){const t=Math.floor(e/2),n=e%2>=1?1:0,r=5-t-n;return'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="#f87719" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(t)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><defs><linearGradient id="half-grad" x1="0" x2="1" y1="0" y2="0"><stop offset="50%" stop-color="#f87719"/><stop offset="50%" stop-color="transparent"/></linearGradient></defs><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="url(#half-grad)" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(n)+'<svg class="movie-catalog-star-icon" viewBox="0 0 24 24" style="margin-right:4px;vertical-align:middle;"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z" fill="none" stroke="#f87719" stroke-width="1.2"/></svg>'.repeat(r)}function ne(e,t){const n=document.createElement("li");n.classList.add("movie-item","movie-catalog-item");const r=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"https://via.placeholder.com/300x450?text=No+Image",i=e.release_date?.split("-")[0]||"Bilinmiyor",l=e.vote_average||0;let a="Tür bilinmiyor";e.genre_ids&&t?a=e.genre_ids.map(o=>t[o]||o).join(", "):e.genres&&Array.isArray(e.genres)&&(a=e.genres.map(o=>o.name).join(", "));const s=te(l);return n.innerHTML=`
    <img src="${r}" alt="${e.title}" class="catalog-film-poster" />
    <div class="catalog-overlay">
      <h3 class="catalog-film-title">${e.title}</h3>
      <div class="movie-catalog-bottom-row">
        <p class="movie-catalog-film-info">${a} | ${i}</p>
        <div class="movie-catalog-stars">${s}</div>
      </div>
    </div>
  `,n.addEventListener("click",()=>{typeof k=="function"&&k(e,t)}),n}function q(e){if(f.innerHTML="",!e||e.length===0){c.style.display="block",u.style.display="none";return}c.style.display="none",u.style.display="",window._genreMap||(window._genreMap=null);const t=window._genreMap;e.forEach(n=>{const r=ne(n,t);r._movieData=n,f.appendChild(r)})}async function re(){if(window._genreMap)return window._genreMap;if(typeof I=="function"){const e=await I();console.log("fetchGenres sonucu:",e);const t={};return e.genres&&Array.isArray(e.genres)&&e.genres.forEach(n=>{t[n.id]=n.name}),window._genreMap=t,t}return null}let $="";const p=document.querySelector(".year-dropdown");p.style.display="none";const oe=p.querySelector(".year-selected"),L=p.querySelector(".year-options"),ae=p.querySelector(".year-label"),le=new Date().getFullYear();for(let e=le;e>=1900;e--){const t=document.createElement("li");t.textContent=e,t.addEventListener("click",()=>{$=e,ae.textContent=e,L.classList.add("hidden")}),L.appendChild(t)}oe.addEventListener("click",e=>{e.stopPropagation(),L.classList.toggle("hidden")});document.addEventListener("click",e=>{p.contains(e.target)||L.classList.add("hidden")});function se(){const e=document.getElementById("search-input");if(!e)return;if(!e.parentNode.classList.contains("search-input-wrapper")){const r=document.createElement("div");r.className="search-input-wrapper",e.parentNode.insertBefore(r,e),r.appendChild(e)}const t=e.parentNode;if(t.querySelector(".search-clear-btn"))return;const n=document.createElement("button");n.type="button",n.className="search-clear-btn",n.innerHTML=`
    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.5 4.5L4.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
      <path d="M4.5 4.5L13.5 13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" />
    </svg>
  `,n.style.display="none",n.addEventListener("click",()=>{e.value="",e.focus(),n.style.display="none"}),t.appendChild(n),e.addEventListener("input",()=>{n.style.display=e.value?"flex":"none"}),n.style.display=e.value?"flex":"none"}document.addEventListener("DOMContentLoaded",()=>{ie(),se()});async function ie(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!v||!f||!c){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}try{let e=[];for(let n=1;n<=ee;n++){const r=await F(n);e=e.concat(r.results)}w=e.slice(0,T),g=Math.ceil(w.length/h),d=1;const t=await re();console.log("Genre map:",t),q(B(d)),C(d,g),u.parentNode||f.parentNode.insertBefore(u,f.nextSibling),v.addEventListener("submit",async n=>{n.preventDefault();const r=document.getElementById("search-input").value.trim(),i=$;if(r)try{let a=(await G(r)).results;i&&(a=a.filter(s=>s.release_date&&s.release_date.startsWith(i))),x=a,g=Math.ceil(a.length/h),d=1,q(B(d,x)),C(d,g),p.style.display="inline-block",v.classList.add("active"),a.length===0?c.style.display="block":c.style.display="none"}catch(l){console.error("Arama sırasında hata oluştu:",l),c.style.display="block",c.textContent="Film bulunamadı veya bir hata oluştu.",p.style.display="inline-block",v.classList.add("active")}})}catch(e){console.error("Filmler yüklenirken hata:",e),c.style.display="block",c.textContent="Filmler yüklenirken hata oluştu."}}
//# sourceMappingURL=catalog.js.map
