(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const m="2609725f661288e9b08bc0d62455b671",p="https://api.themoviedb.org/3";async function x(e=1){return await(await fetch(`${p}/movie/popular?api_key=${m}&page=${e}`)).json()}async function $(){return await(await fetch(`${p}/trending/movie/day?api_key=${m}`)).json()}async function S(){return await(await fetch(`${p}/trending/movie/week?api_key=${m}`)).json()}async function _(){return await(await fetch(`${p}/movie/upcoming?api_key=${m}`)).json()}async function N(e){return await(await fetch(`${p}/movie/${e}?api_key=${m}`)).json()}async function T(e){return await(await fetch(`${p}/movie/${e}/videos?api_key=${m}`)).json()}async function C(e,t=""){return await(await fetch(`${p}/search/movie?api_key=${m}&query=${encodeURIComponent(e)}&year=${t}`)).json()}async function E(){return await(await fetch(`${p}/genre/movie/list?api_key=${m}`)).json()}const w="data:image/svg+xml,%3csvg%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11.25%2011.25L0.75%200.75M11.25%200.75L0.75%2011.25'%20stroke='%23F8F8F8'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",M="data:image/svg+xml,%3csvg%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11.25%2011.25L0.75%200.75M11.25%200.75L0.75%2011.25'%20stroke='%23F87719'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";let h=null;async function q(){if(h)return h;const e=await E();return h={},e.genres&&Array.isArray(e.genres)&&e.genres.forEach(t=>{h[t.id]=t.name}),h}function k(){const e=localStorage.getItem("library");return e?JSON.parse(e):[]}function A(e){localStorage.setItem("library",JSON.stringify(e))}function B(e,t){let o=k();const i=e.id;o.includes(i)?(o=o.filter(r=>r!==i),t.textContent="Add to library",t.classList.remove("removed")):(o.push(i),t.textContent="Remove from my library",t.classList.add("removed")),A(o)}function D(e,t){k().includes(e.id)?(t.textContent="Remove from my library",t.classList.add("removed")):(t.textContent="Add to library",t.classList.remove("removed"))}async function P(e){let t=document.querySelector("#popup-template");if(!t){const i=window.location.hostname==="localhost";let r;i?r="/popup.html":r=`/${window.location.pathname.split("/")[1]}/popup.html`,fetch(r).then(n=>{if(!n.ok)throw console.error(`Popup.html yüklenemedi. Durum: ${n.status}, URL: ${n.url}`),new Error("Network response was not ok.");return n.text()}).then(async n=>{const l=document.createElement("div");l.innerHTML=n;const a=l.querySelector(".movie-popup-overlay");a?(a.id="popup-template",document.body.appendChild(a),await L(a,e)):console.error("movie-popup-overlay bulunamadı, HTML içeriği yanlış olabilir.")}).catch(n=>{console.error("Popup yüklenirken bir hata oluştu:",n)});return}const o=t.cloneNode(!0);o.id="",await L(o,e)}async function L(e,t){e.style.display="flex";const o=e.querySelector(".movie-popup-img");o.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",o.alt=t.title,e.querySelector(".movie-popup-title").textContent=t.title;const i=t.vote_average!=null?t.vote_average.toFixed(1):"-";e.querySelector(".vote-avg").textContent=i,e.querySelector(".vote-count").textContent=t.vote_count??"-";const r=t.popularity!=null?t.popularity.toFixed(1):"-";e.querySelector(".popularity-value").textContent=r;let n="-";if(t.genre_names&&Array.isArray(t.genre_names))n=t.genre_names.join(", ");else if(t.genre_ids&&Array.isArray(t.genre_ids)){const s=await q();n=t.genre_ids.map(u=>s[u]||u).join(", ")}e.querySelector(".genre-value").textContent=n,e.querySelector(".about-value").textContent=t.overview||"No description.";const l=e.querySelector(".movie-popup-add-btn");l&&(D(t,l),l.addEventListener("click",function(){B(t,this)}));const a=e.querySelector(".movie-popup-close");let c=a.querySelector("img");if(c||(c=document.createElement("img"),c.alt="close",c.className="close-icon",c.width=24,c.height=24,c.style.width="24px",c.style.height="24px",c.src=w,a.appendChild(c)),window.location.hostname==="localhost"||window.location.pathname.split("/")[1],a.addEventListener("mouseenter",()=>{a.querySelector("img").src=M}),a.addEventListener("mouseleave",()=>{a.querySelector("img").src=w}),a.addEventListener("click",()=>e.remove()),e.addEventListener("mousedown",function(s){s.target===e&&e.remove()}),document.body.appendChild(e),a){a.innerHTML="";const s=document.createElement("img");s.alt="close",s.className="close-icon",s.width=24,s.height=24,s.style.width="24px",s.style.height="24px",s.src=w,a.appendChild(s)}}console.log("catalog.js yüklendi!");const g=document.getElementById("search-form"),f=document.getElementById("movie-list"),d=document.getElementById("no-results"),y=document.getElementById("year-select");function j(){f.addEventListener("click",e=>{const t=e.target.closest("li.movie-item");if(!t)return;const o=Array.from(f.children).indexOf(t),r=Array.from(f.children).map(n=>n._movieData).filter(Boolean)[o];r&&P(r)})}function b(e){if(f.innerHTML="",!e||e.length===0){d.style.display="block";return}d.style.display="none",e.slice(0,21).forEach(o=>{const i=document.createElement("li");i.classList.add("movie-item"),i.innerHTML=`
      <img src="https://image.tmdb.org/t/p/original${o.poster_path}" alt="${o.title}" />
      <h3>${o.title}</h3>
      <p>Yayın Tarihi: ${o.release_date||"Bilinmiyor"}</p>
    `,i._movieData=o,f.appendChild(i)})}function I(){const e=new Date().getFullYear();for(let t=e;t>=1900;t--){const o=document.createElement("option");o.value=t,o.textContent=t,y.appendChild(o)}}async function F(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!g||!f||!d||!y){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}I();try{const[e,t,o,i]=await Promise.all([x(),$(),S(),_()]),r=[...e.results,...t.results,...o.results,...i.results],n=new Map;r.forEach(l=>{n.has(l.id)||n.set(l.id,l)}),b(Array.from(n.values())),g.addEventListener("submit",async l=>{l.preventDefault();const a=document.getElementById("search-input").value.trim(),c=y.value;if(a)try{let s=(await C(a)).results;if(c&&(s=s.filter(u=>u.release_date&&u.release_date.startsWith(c))),b(s),s.length===0)d.style.display="block",d.textContent="Aradığınız kriterlere uygun film bulunamadı.";else{d.style.display="none",y.style.display="inline-block";const u=g.querySelector(".search-button");u&&y&&g.insertBefore(y,u)}}catch(v){console.error("Arama sırasında hata oluştu:",v),d.style.display="block",d.textContent="Film bulunamadı veya bir hata oluştu."}})}catch(e){console.error("Filmler yüklenirken hata:",e),d.style.display="block",d.textContent="Filmler yüklenirken hata oluştu."}}document.addEventListener("DOMContentLoaded",()=>{F(),j()});export{N as a,E as b,T as c,$ as f,F as i};
//# sourceMappingURL=catalog-Dy8ybqnI.js.map
